.include "macros.inc"

.section .text, "ax"  # 0x8000C860 - 0x804064E0

.global NWC24iCheckUserIdCRC
NWC24iCheckUserIdCRC:
/* 803A1FF0 00397D70  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 803A1FF4 00397D74  7C 08 02 A6 */	mflr r0
/* 803A1FF8 00397D78  90 01 00 24 */	stw r0, 0x24(r1)
/* 803A1FFC 00397D7C  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 803A2000 00397D80  93 C1 00 18 */	stw r30, 0x18(r1)
/* 803A2004 00397D84  93 A1 00 14 */	stw r29, 0x14(r1)
/* 803A2008 00397D88  48 00 00 81 */	bl getUnScrambleId
/* 803A200C 00397D8C  7C 9E 23 78 */	mr r30, r4
/* 803A2010 00397D90  7C 7F 1B 78 */	mr r31, r3
/* 803A2014 00397D94  3B A0 00 00 */	li r29, 0
lbl_803A2018:
/* 803A2018 00397D98  38 1D 00 01 */	addi r0, r29, 1
/* 803A201C 00397D9C  7F E3 FB 78 */	mr r3, r31
/* 803A2020 00397DA0  7F C4 F3 78 */	mr r4, r30
/* 803A2024 00397DA4  20 A0 00 35 */	subfic r5, r0, 0x35
/* 803A2028 00397DA8  48 04 F7 95 */	bl __shr2u
/* 803A202C 00397DAC  54 80 07 FF */	clrlwi. r0, r4, 0x1f
/* 803A2030 00397DB0  41 82 00 1C */	beq lbl_803A204C
/* 803A2034 00397DB4  20 BD 00 2A */	subfic r5, r29, 0x2a
/* 803A2038 00397DB8  38 80 06 35 */	li r4, 0x635
/* 803A203C 00397DBC  38 60 00 00 */	li r3, 0
/* 803A2040 00397DC0  48 04 F7 59 */	bl __shl2i
/* 803A2044 00397DC4  7F DE 22 78 */	xor r30, r30, r4
/* 803A2048 00397DC8  7F FF 1A 78 */	xor r31, r31, r3
lbl_803A204C:
/* 803A204C 00397DCC  3B BD 00 01 */	addi r29, r29, 1
/* 803A2050 00397DD0  2C 1D 00 2B */	cmpwi r29, 0x2b
/* 803A2054 00397DD4  41 80 FF C4 */	blt lbl_803A2018
/* 803A2058 00397DD8  7F C0 FB 79 */	or. r0, r30, r31
/* 803A205C 00397DDC  41 82 00 0C */	beq lbl_803A2068
/* 803A2060 00397DE0  38 60 FF DB */	li r3, -37
/* 803A2064 00397DE4  48 00 00 08 */	b lbl_803A206C
lbl_803A2068:
/* 803A2068 00397DE8  38 60 00 00 */	li r3, 0
lbl_803A206C:
/* 803A206C 00397DEC  80 01 00 24 */	lwz r0, 0x24(r1)
/* 803A2070 00397DF0  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 803A2074 00397DF4  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 803A2078 00397DF8  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 803A207C 00397DFC  7C 08 03 A6 */	mtlr r0
/* 803A2080 00397E00  38 21 00 20 */	addi r1, r1, 0x20
/* 803A2084 00397E04  4E 80 00 20 */	blr 

.global getUnScrambleId
getUnScrambleId:
/* 803A2088 00397E08  39 20 FF FF */	li r9, -1
/* 803A208C 00397E0C  3C E0 00 20 */	lis r7, 0x001FFFFF@ha
/* 803A2090 00397E10  3C C0 5E 5E */	lis r6, 0x5E5E5E5E@ha
/* 803A2094 00397E14  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 803A2098 00397E18  38 E7 FF FF */	addi r7, r7, 0x001FFFFF@l
/* 803A209C 00397E1C  7C 88 48 38 */	and r8, r4, r9
/* 803A20A0 00397E20  38 06 5E 5E */	addi r0, r6, 0x5E5E5E5E@l
/* 803A20A4 00397E24  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 803A20A8 00397E28  7C 63 38 38 */	and r3, r3, r7
/* 803A20AC 00397E2C  3C A0 FF FF */	lis r5, 0xFFFF00FF@ha
/* 803A20B0 00397E30  7D 08 02 78 */	xor r8, r8, r0
/* 803A20B4 00397E34  93 C1 00 18 */	stw r30, 0x18(r1)
/* 803A20B8 00397E38  7D 08 48 38 */	and r8, r8, r9
/* 803A20BC 00397E3C  68 63 5E 5E */	xori r3, r3, 0x5e5e
/* 803A20C0 00397E40  55 00 AA 94 */	rlwinm r0, r8, 0x15, 0xa, 0xa
/* 803A20C4 00397E44  38 C0 FF 00 */	li r6, -256
/* 803A20C8 00397E48  7C 63 38 38 */	and r3, r3, r7
/* 803A20CC 00397E4C  55 08 F8 3E */	rotlwi r8, r8, 0x1f
/* 803A20D0 00397E50  7C 63 03 78 */	or r3, r3, r0
/* 803A20D4 00397E54  93 A1 00 14 */	stw r29, 0x14(r1)
/* 803A20D8 00397E58  50 68 F8 00 */	rlwimi r8, r3, 0x1f, 0, 0
/* 803A20DC 00397E5C  3C 80 FF 01 */	lis r4, 0xFF00FFFF@ha
/* 803A20E0 00397E60  54 67 F8 7E */	srwi r7, r3, 1
/* 803A20E4 00397E64  38 A5 00 FF */	addi r5, r5, 0xFFFF00FF@l
/* 803A20E8 00397E68  55 1E C0 3E */	rotlwi r30, r8, 0x18
/* 803A20EC 00397E6C  54 7D BE 3E */	rlwinm r29, r3, 0x17, 0x18, 0x1f
/* 803A20F0 00397E70  7C EC 48 38 */	and r12, r7, r9
/* 803A20F4 00397E74  38 00 00 00 */	li r0, 0
/* 803A20F8 00397E78  50 7E B8 0E */	rlwimi r30, r3, 0x17, 0, 7
/* 803A20FC 00397E7C  7D 1F 30 38 */	and r31, r8, r6
/* 803A2100 00397E80  53 DF 06 3E */	rlwimi r31, r30, 0, 0x18, 0x1f
/* 803A2104 00397E84  54 6B FC 2E */	rlwinm r11, r3, 0x1f, 0x10, 0x17
/* 803A2108 00397E88  7F FE 28 38 */	and r30, r31, r5
/* 803A210C 00397E8C  7D 8C 48 38 */	and r12, r12, r9
/* 803A2110 00397E90  53 A0 46 3E */	rlwimi r0, r29, 8, 0x18, 0x1f
/* 803A2114 00397E94  38 84 FF FF */	addi r4, r4, 0xFF00FFFF@l
/* 803A2118 00397E98  7D 8C 03 78 */	or r12, r12, r0
/* 803A211C 00397E9C  7F CB 5B 78 */	or r11, r30, r11
/* 803A2120 00397EA0  7D 7E 20 38 */	and r30, r11, r4
/* 803A2124 00397EA4  55 1F 06 3E */	clrlwi r31, r8, 0x18
/* 803A2128 00397EA8  38 00 00 00 */	li r0, 0
/* 803A212C 00397EAC  55 0B 82 1E */	rlwinm r11, r8, 0x10, 8, 0xf
/* 803A2130 00397EB0  3D 40 01 00 */	lis r10, 0x00FFFFFF@ha
/* 803A2134 00397EB4  7D 8C 48 38 */	and r12, r12, r9
/* 803A2138 00397EB8  53 E0 84 3E */	rlwimi r0, r31, 0x10, 0x10, 0x1f
/* 803A213C 00397EBC  7F DE 5B 78 */	or r30, r30, r11
/* 803A2140 00397EC0  7D 9D 03 78 */	or r29, r12, r0
/* 803A2144 00397EC4  54 6C FE 3E */	rlwinm r12, r3, 0x1f, 0x18, 0x1f
/* 803A2148 00397EC8  38 0A FF FF */	addi r0, r10, 0x00FFFFFF@l
/* 803A214C 00397ECC  39 40 00 00 */	li r10, 0
/* 803A2150 00397ED0  51 8A C2 3E */	rlwimi r10, r12, 0x18, 8, 0x1f
/* 803A2154 00397ED4  7F AB 48 38 */	and r11, r29, r9
/* 803A2158 00397ED8  7F CC 00 38 */	and r12, r30, r0
/* 803A215C 00397EDC  54 63 B8 0E */	rlwinm r3, r3, 0x17, 0, 7
/* 803A2160 00397EE0  7D 83 1B 78 */	or r3, r12, r3
/* 803A2164 00397EE4  7D 6C 53 78 */	or r12, r11, r10
/* 803A2168 00397EE8  7C 6A 48 38 */	and r10, r3, r9
/* 803A216C 00397EEC  3C 60 80 41 */	lis r3, lbl_80416940@ha
/* 803A2170 00397EF0  7D 5F 48 38 */	and r31, r10, r9
/* 803A2174 00397EF4  55 1E 80 3E */	rotlwi r30, r8, 0x10
/* 803A2178 00397EF8  57 EB E7 3E */	rlwinm r11, r31, 0x1c, 0x1c, 0x1f
/* 803A217C 00397EFC  38 63 69 40 */	addi r3, r3, lbl_80416940@l
/* 803A2180 00397F00  50 FE 80 1E */	rlwimi r30, r7, 0x10, 0, 0xf
/* 803A2184 00397F04  57 EA 07 3E */	clrlwi r10, r31, 0x1c
/* 803A2188 00397F08  7D 9D 30 38 */	and r29, r12, r6
/* 803A218C 00397F0C  55 0C 40 3E */	rotlwi r12, r8, 8
/* 803A2190 00397F10  7D 63 58 AE */	lbzx r11, r3, r11
/* 803A2194 00397F14  50 EC 40 2E */	rlwimi r12, r7, 8, 0, 0x17
/* 803A2198 00397F18  7C E3 50 AE */	lbzx r7, r3, r10
/* 803A219C 00397F1C  53 DD 06 3E */	rlwimi r29, r30, 0, 0x18, 0x1f
/* 803A21A0 00397F20  55 68 20 36 */	slwi r8, r11, 4
/* 803A21A4 00397F24  55 8A 44 2E */	rlwinm r10, r12, 8, 0x10, 0x17
/* 803A21A8 00397F28  7F AB 28 38 */	and r11, r29, r5
/* 803A21AC 00397F2C  7D 6A 53 78 */	or r10, r11, r10
/* 803A21B0 00397F30  7D 07 3B 78 */	or r7, r8, r7
/* 803A21B4 00397F34  7F EB 30 38 */	and r11, r31, r6
/* 803A21B8 00397F38  39 00 00 00 */	li r8, 0
/* 803A21BC 00397F3C  50 EB 06 3E */	rlwimi r11, r7, 0, 0x18, 0x1f
/* 803A21C0 00397F40  7D 4C 48 38 */	and r12, r10, r9
/* 803A21C4 00397F44  55 6A C0 3E */	rotlwi r10, r11, 0x18
/* 803A21C8 00397F48  38 E0 00 00 */	li r7, 0
/* 803A21CC 00397F4C  51 8A C0 0E */	rlwimi r10, r12, 0x18, 0, 7
/* 803A21D0 00397F50  7D 7F 28 38 */	and r31, r11, r5
/* 803A21D4 00397F54  55 4B E7 3E */	rlwinm r11, r10, 0x1c, 0x1c, 0x1f
/* 803A21D8 00397F58  7D 8C 48 38 */	and r12, r12, r9
/* 803A21DC 00397F5C  55 4A 07 3E */	clrlwi r10, r10, 0x1c
/* 803A21E0 00397F60  7D 63 58 AE */	lbzx r11, r3, r11
/* 803A21E4 00397F64  7D 43 50 AE */	lbzx r10, r3, r10
/* 803A21E8 00397F68  55 6B 20 36 */	slwi r11, r11, 4
/* 803A21EC 00397F6C  7D 6A 53 78 */	or r10, r11, r10
/* 803A21F0 00397F70  55 4B 06 3E */	clrlwi r11, r10, 0x18
/* 803A21F4 00397F74  55 4A 44 2E */	rlwinm r10, r10, 8, 0x10, 0x17
/* 803A21F8 00397F78  51 68 46 3E */	rlwimi r8, r11, 8, 0x18, 0x1f
/* 803A21FC 00397F7C  7F EA 53 78 */	or r10, r31, r10
/* 803A2200 00397F80  7D 88 43 78 */	or r8, r12, r8
/* 803A2204 00397F84  55 4C 80 3E */	rotlwi r12, r10, 0x10
/* 803A2208 00397F88  7D 4B 20 38 */	and r11, r10, r4
/* 803A220C 00397F8C  51 0C 80 1E */	rlwimi r12, r8, 0x10, 0, 0xf
/* 803A2210 00397F90  7D 0A 48 38 */	and r10, r8, r9
/* 803A2214 00397F94  55 88 E7 3E */	rlwinm r8, r12, 0x1c, 0x1c, 0x1f
/* 803A2218 00397F98  55 84 07 3E */	clrlwi r4, r12, 0x1c
/* 803A221C 00397F9C  7D 03 40 AE */	lbzx r8, r3, r8
/* 803A2220 00397FA0  7C 83 20 AE */	lbzx r4, r3, r4
/* 803A2224 00397FA4  55 08 20 36 */	slwi r8, r8, 4
/* 803A2228 00397FA8  7D 04 23 78 */	or r4, r8, r4
/* 803A222C 00397FAC  54 88 06 3E */	clrlwi r8, r4, 0x18
/* 803A2230 00397FB0  54 84 82 1E */	rlwinm r4, r4, 0x10, 8, 0xf
/* 803A2234 00397FB4  7D 7D 23 78 */	or r29, r11, r4
/* 803A2238 00397FB8  51 07 84 3E */	rlwimi r7, r8, 0x10, 0x10, 0x1f
/* 803A223C 00397FBC  7D 4B 3B 78 */	or r11, r10, r7
/* 803A2240 00397FC0  3C 80 00 01 */	lis r4, 0x0000B3B3@ha
/* 803A2244 00397FC4  57 A8 40 3E */	rotlwi r8, r29, 8
/* 803A2248 00397FC8  7F BF 00 38 */	and r31, r29, r0
/* 803A224C 00397FCC  51 68 40 2E */	rlwimi r8, r11, 8, 0, 0x17
/* 803A2250 00397FD0  7D 6C 48 38 */	and r12, r11, r9
/* 803A2254 00397FD4  55 0A E7 3E */	rlwinm r10, r8, 0x1c, 0x1c, 0x1f
/* 803A2258 00397FD8  38 04 B3 B3 */	addi r0, r4, 0x0000B3B3@l
/* 803A225C 00397FDC  7D 63 50 AE */	lbzx r11, r3, r10
/* 803A2260 00397FE0  55 08 07 3E */	clrlwi r8, r8, 0x1c
/* 803A2264 00397FE4  7D 43 40 AE */	lbzx r10, r3, r8
/* 803A2268 00397FE8  39 00 00 00 */	li r8, 0
/* 803A226C 00397FEC  55 6B 20 36 */	slwi r11, r11, 4
/* 803A2270 00397FF0  3C E0 B3 B4 */	lis r7, 0xB3B3B3B3@ha
/* 803A2274 00397FF4  7D 6B 53 78 */	or r11, r11, r10
/* 803A2278 00397FF8  55 6A 06 3E */	clrlwi r10, r11, 0x18
/* 803A227C 00397FFC  38 E7 B3 B3 */	addi r7, r7, 0xB3B3B3B3@l
/* 803A2280 00398000  51 48 C2 3E */	rlwimi r8, r10, 0x18, 8, 0x1f
/* 803A2284 00398004  55 64 C0 0E */	slwi r4, r11, 0x18
/* 803A2288 00398008  7D 8A 43 78 */	or r10, r12, r8
/* 803A228C 0039800C  55 48 E7 3E */	rlwinm r8, r10, 0x1c, 0x1c, 0x1f
/* 803A2290 00398010  7F EC 23 78 */	or r12, r31, r4
/* 803A2294 00398014  55 44 07 3E */	clrlwi r4, r10, 0x1c
/* 803A2298 00398018  7D 03 40 AE */	lbzx r8, r3, r8
/* 803A229C 0039801C  7D 4B 30 38 */	and r11, r10, r6
/* 803A22A0 00398020  7C 83 20 AE */	lbzx r4, r3, r4
/* 803A22A4 00398024  55 06 20 36 */	slwi r6, r8, 4
/* 803A22A8 00398028  7D 88 48 38 */	and r8, r12, r9
/* 803A22AC 0039802C  7C C4 23 78 */	or r4, r6, r4
/* 803A22B0 00398030  50 8B 06 3E */	rlwimi r11, r4, 0, 0x18, 0x1f
/* 803A22B4 00398034  7D 0A 48 38 */	and r10, r8, r9
/* 803A22B8 00398038  55 66 A7 3E */	rlwinm r6, r11, 0x14, 0x1c, 0x1f
/* 803A22BC 0039803C  55 64 C7 3E */	rlwinm r4, r11, 0x18, 0x1c, 0x1f
/* 803A22C0 00398040  7C C3 30 AE */	lbzx r6, r3, r6
/* 803A22C4 00398044  7C 63 20 AE */	lbzx r3, r3, r4
/* 803A22C8 00398048  7D 68 28 38 */	and r8, r11, r5
/* 803A22CC 0039804C  54 C5 20 36 */	slwi r5, r6, 4
/* 803A22D0 00398050  7D 44 48 38 */	and r4, r10, r9
/* 803A22D4 00398054  7C A3 1B 78 */	or r3, r5, r3
/* 803A22D8 00398058  54 63 44 2E */	rlwinm r3, r3, 8, 0x10, 0x17
/* 803A22DC 0039805C  7D 03 1B 78 */	or r3, r8, r3
/* 803A22E0 00398060  54 65 52 EA */	rlwinm r5, r3, 0xa, 0xb, 0x15
/* 803A22E4 00398064  54 63 AD BE */	rlwinm r3, r3, 0x15, 0x16, 0x1f
/* 803A22E8 00398068  50 85 55 BE */	rlwimi r5, r4, 0xa, 0x16, 0x1f
/* 803A22EC 0039806C  50 83 50 2A */	rlwimi r3, r4, 0xa, 0, 0x15
/* 803A22F0 00398070  7C 64 3A 78 */	xor r4, r3, r7
/* 803A22F4 00398074  7C A3 02 78 */	xor r3, r5, r0
/* 803A22F8 00398078  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 803A22FC 0039807C  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 803A2300 00398080  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 803A2304 00398084  38 21 00 20 */	addi r1, r1, 0x20
/* 803A2308 00398088  4E 80 00 20 */	blr 

