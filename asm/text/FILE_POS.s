.include "macros.inc"

.section .text, "ax"  # 0x8000C860 - 0x804064E0

.global _ftell
_ftell:
/* 803F5C38 003EB9B8  80 03 00 04 */	lwz r0, 4(r3)
/* 803F5C3C 003EB9BC  38 C0 00 00 */	li r6, 0
/* 803F5C40 003EB9C0  54 04 57 7E */	rlwinm r4, r0, 0xa, 0x1d, 0x1f
/* 803F5C44 003EB9C4  38 04 00 FF */	addi r0, r4, 0xff
/* 803F5C48 003EB9C8  54 00 06 3E */	clrlwi r0, r0, 0x18
/* 803F5C4C 003EB9CC  28 00 00 01 */	cmplwi r0, 1
/* 803F5C50 003EB9D0  41 81 00 10 */	bgt lbl_803F5C60
/* 803F5C54 003EB9D4  88 03 00 0A */	lbz r0, 0xa(r3)
/* 803F5C58 003EB9D8  2C 00 00 00 */	cmpwi r0, 0
/* 803F5C5C 003EB9DC  41 82 00 14 */	beq lbl_803F5C70
lbl_803F5C60:
/* 803F5C60 003EB9E0  38 00 00 28 */	li r0, 0x28
/* 803F5C64 003EB9E4  38 60 FF FF */	li r3, -1
/* 803F5C68 003EB9E8  90 0D CE C0 */	stw r0, lbl_805A12E0-_SDA_BASE_(r13)
/* 803F5C6C 003EB9EC  4E 80 00 20 */	blr 
lbl_803F5C70:
/* 803F5C70 003EB9F0  80 03 00 08 */	lwz r0, 8(r3)
/* 803F5C74 003EB9F4  54 05 1F 7F */	rlwinm. r5, r0, 3, 0x1d, 0x1f
/* 803F5C78 003EB9F8  40 82 00 0C */	bne lbl_803F5C84
/* 803F5C7C 003EB9FC  80 63 00 18 */	lwz r3, 0x18(r3)
/* 803F5C80 003EBA00  4E 80 00 20 */	blr 
lbl_803F5C84:
/* 803F5C84 003EBA04  81 03 00 1C */	lwz r8, 0x1c(r3)
/* 803F5C88 003EBA08  28 05 00 03 */	cmplwi r5, 3
/* 803F5C8C 003EBA0C  80 83 00 24 */	lwz r4, 0x24(r3)
/* 803F5C90 003EBA10  80 03 00 34 */	lwz r0, 0x34(r3)
/* 803F5C94 003EBA14  7C 88 20 50 */	subf r4, r8, r4
/* 803F5C98 003EBA18  7C E0 22 14 */	add r7, r0, r4
/* 803F5C9C 003EBA1C  41 80 00 0C */	blt lbl_803F5CA8
/* 803F5CA0 003EBA20  38 C5 FF FE */	addi r6, r5, -2
/* 803F5CA4 003EBA24  7C E6 38 50 */	subf r7, r6, r7
lbl_803F5CA8:
/* 803F5CA8 003EBA28  80 03 00 04 */	lwz r0, 4(r3)
/* 803F5CAC 003EBA2C  54 00 6F FF */	rlwinm. r0, r0, 0xd, 0x1f, 0x1f
/* 803F5CB0 003EBA30  40 82 00 28 */	bne lbl_803F5CD8
/* 803F5CB4 003EBA34  7C 06 20 51 */	subf. r0, r6, r4
/* 803F5CB8 003EBA38  7C 09 03 A6 */	mtctr r0
/* 803F5CBC 003EBA3C  41 82 00 1C */	beq lbl_803F5CD8
lbl_803F5CC0:
/* 803F5CC0 003EBA40  88 08 00 00 */	lbz r0, 0(r8)
/* 803F5CC4 003EBA44  39 08 00 01 */	addi r8, r8, 1
/* 803F5CC8 003EBA48  28 00 00 0A */	cmplwi r0, 0xa
/* 803F5CCC 003EBA4C  40 82 00 08 */	bne lbl_803F5CD4
/* 803F5CD0 003EBA50  38 E7 00 01 */	addi r7, r7, 1
lbl_803F5CD4:
/* 803F5CD4 003EBA54  42 00 FF EC */	bdnz lbl_803F5CC0
lbl_803F5CD8:
/* 803F5CD8 003EBA58  7C E3 3B 78 */	mr r3, r7
/* 803F5CDC 003EBA5C  4E 80 00 20 */	blr 

.global ftell
ftell:
/* 803F5CE0 003EBA60  4B FF FF 58 */	b _ftell

.global _fseek
_fseek:
/* 803F5CE4 003EBA64  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 803F5CE8 003EBA68  7C 08 02 A6 */	mflr r0
/* 803F5CEC 003EBA6C  90 01 00 24 */	stw r0, 0x24(r1)
/* 803F5CF0 003EBA70  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 803F5CF4 003EBA74  7C BF 2B 78 */	mr r31, r5
/* 803F5CF8 003EBA78  93 C1 00 18 */	stw r30, 0x18(r1)
/* 803F5CFC 003EBA7C  7C 7E 1B 78 */	mr r30, r3
/* 803F5D00 003EBA80  90 81 00 08 */	stw r4, 8(r1)
/* 803F5D04 003EBA84  80 03 00 04 */	lwz r0, 4(r3)
/* 803F5D08 003EBA88  54 00 57 7E */	rlwinm r0, r0, 0xa, 0x1d, 0x1f
/* 803F5D0C 003EBA8C  28 00 00 01 */	cmplwi r0, 1
/* 803F5D10 003EBA90  40 82 00 10 */	bne lbl_803F5D20
/* 803F5D14 003EBA94  88 03 00 0A */	lbz r0, 0xa(r3)
/* 803F5D18 003EBA98  2C 00 00 00 */	cmpwi r0, 0
/* 803F5D1C 003EBA9C  41 82 00 14 */	beq lbl_803F5D30
lbl_803F5D20:
/* 803F5D20 003EBAA0  38 00 00 28 */	li r0, 0x28
/* 803F5D24 003EBAA4  38 60 FF FF */	li r3, -1
/* 803F5D28 003EBAA8  90 0D CE C0 */	stw r0, lbl_805A12E0-_SDA_BASE_(r13)
/* 803F5D2C 003EBAAC  48 00 01 64 */	b lbl_803F5E90
lbl_803F5D30:
/* 803F5D30 003EBAB0  80 03 00 08 */	lwz r0, 8(r3)
/* 803F5D34 003EBAB4  54 00 1F 7E */	srwi r0, r0, 0x1d
/* 803F5D38 003EBAB8  28 00 00 01 */	cmplwi r0, 1
/* 803F5D3C 003EBABC  40 82 00 34 */	bne lbl_803F5D70
/* 803F5D40 003EBAC0  38 80 00 00 */	li r4, 0
/* 803F5D44 003EBAC4  4B FF F4 51 */	bl __flush_buffer
/* 803F5D48 003EBAC8  2C 03 00 00 */	cmpwi r3, 0
/* 803F5D4C 003EBACC  41 82 00 24 */	beq lbl_803F5D70
/* 803F5D50 003EBAD0  38 00 00 01 */	li r0, 1
/* 803F5D54 003EBAD4  38 80 00 00 */	li r4, 0
/* 803F5D58 003EBAD8  98 1E 00 0A */	stb r0, 0xa(r30)
/* 803F5D5C 003EBADC  38 00 00 28 */	li r0, 0x28
/* 803F5D60 003EBAE0  38 60 FF FF */	li r3, -1
/* 803F5D64 003EBAE4  90 9E 00 28 */	stw r4, 0x28(r30)
/* 803F5D68 003EBAE8  90 0D CE C0 */	stw r0, lbl_805A12E0-_SDA_BASE_(r13)
/* 803F5D6C 003EBAEC  48 00 01 24 */	b lbl_803F5E90
lbl_803F5D70:
/* 803F5D70 003EBAF0  2C 1F 00 01 */	cmpwi r31, 1
/* 803F5D74 003EBAF4  40 82 00 1C */	bne lbl_803F5D90
/* 803F5D78 003EBAF8  7F C3 F3 78 */	mr r3, r30
/* 803F5D7C 003EBAFC  3B E0 00 00 */	li r31, 0
/* 803F5D80 003EBB00  4B FF FE B9 */	bl _ftell
/* 803F5D84 003EBB04  80 01 00 08 */	lwz r0, 8(r1)
/* 803F5D88 003EBB08  7C 00 1A 14 */	add r0, r0, r3
/* 803F5D8C 003EBB0C  90 01 00 08 */	stw r0, 8(r1)
lbl_803F5D90:
/* 803F5D90 003EBB10  2C 1F 00 02 */	cmpwi r31, 2
/* 803F5D94 003EBB14  41 82 00 80 */	beq lbl_803F5E14
/* 803F5D98 003EBB18  80 1E 00 04 */	lwz r0, 4(r30)
/* 803F5D9C 003EBB1C  54 00 2F 7E */	rlwinm r0, r0, 5, 0x1d, 0x1f
/* 803F5DA0 003EBB20  28 00 00 03 */	cmplwi r0, 3
/* 803F5DA4 003EBB24  41 82 00 70 */	beq lbl_803F5E14
/* 803F5DA8 003EBB28  80 DE 00 08 */	lwz r6, 8(r30)
/* 803F5DAC 003EBB2C  54 C3 1F 7E */	srwi r3, r6, 0x1d
/* 803F5DB0 003EBB30  38 03 FF FE */	addi r0, r3, -2
/* 803F5DB4 003EBB34  28 00 00 01 */	cmplwi r0, 1
/* 803F5DB8 003EBB38  41 81 00 5C */	bgt lbl_803F5E14
/* 803F5DBC 003EBB3C  80 61 00 08 */	lwz r3, 8(r1)
/* 803F5DC0 003EBB40  80 BE 00 18 */	lwz r5, 0x18(r30)
/* 803F5DC4 003EBB44  7C 03 28 40 */	cmplw r3, r5
/* 803F5DC8 003EBB48  40 80 00 10 */	bge lbl_803F5DD8
/* 803F5DCC 003EBB4C  80 1E 00 34 */	lwz r0, 0x34(r30)
/* 803F5DD0 003EBB50  7C 03 00 40 */	cmplw r3, r0
/* 803F5DD4 003EBB54  40 80 00 14 */	bge lbl_803F5DE8
lbl_803F5DD8:
/* 803F5DD8 003EBB58  80 1E 00 08 */	lwz r0, 8(r30)
/* 803F5DDC 003EBB5C  54 00 00 FE */	clrlwi r0, r0, 3
/* 803F5DE0 003EBB60  90 1E 00 08 */	stw r0, 8(r30)
/* 803F5DE4 003EBB64  48 00 00 3C */	b lbl_803F5E20
lbl_803F5DE8:
/* 803F5DE8 003EBB68  80 9E 00 1C */	lwz r4, 0x1c(r30)
/* 803F5DEC 003EBB6C  7C 60 18 50 */	subf r3, r0, r3
/* 803F5DF0 003EBB70  38 00 00 02 */	li r0, 2
/* 803F5DF4 003EBB74  7C 64 1A 14 */	add r3, r4, r3
/* 803F5DF8 003EBB78  90 7E 00 24 */	stw r3, 0x24(r30)
/* 803F5DFC 003EBB7C  50 06 E8 04 */	rlwimi r6, r0, 0x1d, 0, 2
/* 803F5E00 003EBB80  80 01 00 08 */	lwz r0, 8(r1)
/* 803F5E04 003EBB84  7C 00 28 50 */	subf r0, r0, r5
/* 803F5E08 003EBB88  90 DE 00 08 */	stw r6, 8(r30)
/* 803F5E0C 003EBB8C  90 1E 00 28 */	stw r0, 0x28(r30)
/* 803F5E10 003EBB90  48 00 00 10 */	b lbl_803F5E20
lbl_803F5E14:
/* 803F5E14 003EBB94  80 1E 00 08 */	lwz r0, 8(r30)
/* 803F5E18 003EBB98  54 00 00 FE */	clrlwi r0, r0, 3
/* 803F5E1C 003EBB9C  90 1E 00 08 */	stw r0, 8(r30)
lbl_803F5E20:
/* 803F5E20 003EBBA0  80 1E 00 08 */	lwz r0, 8(r30)
/* 803F5E24 003EBBA4  54 00 1F 7F */	rlwinm. r0, r0, 3, 0x1d, 0x1f
/* 803F5E28 003EBBA8  40 82 00 64 */	bne lbl_803F5E8C
/* 803F5E2C 003EBBAC  81 9E 00 38 */	lwz r12, 0x38(r30)
/* 803F5E30 003EBBB0  2C 0C 00 00 */	cmpwi r12, 0
/* 803F5E34 003EBBB4  41 82 00 44 */	beq lbl_803F5E78
/* 803F5E38 003EBBB8  7F E5 FB 78 */	mr r5, r31
/* 803F5E3C 003EBBBC  38 81 00 08 */	addi r4, r1, 8
/* 803F5E40 003EBBC0  80 7E 00 00 */	lwz r3, 0(r30)
/* 803F5E44 003EBBC4  80 DE 00 48 */	lwz r6, 0x48(r30)
/* 803F5E48 003EBBC8  7D 89 03 A6 */	mtctr r12
/* 803F5E4C 003EBBCC  4E 80 04 21 */	bctrl 
/* 803F5E50 003EBBD0  2C 03 00 00 */	cmpwi r3, 0
/* 803F5E54 003EBBD4  41 82 00 24 */	beq lbl_803F5E78
/* 803F5E58 003EBBD8  38 00 00 01 */	li r0, 1
/* 803F5E5C 003EBBDC  38 80 00 00 */	li r4, 0
/* 803F5E60 003EBBE0  98 1E 00 0A */	stb r0, 0xa(r30)
/* 803F5E64 003EBBE4  38 00 00 28 */	li r0, 0x28
/* 803F5E68 003EBBE8  38 60 FF FF */	li r3, -1
/* 803F5E6C 003EBBEC  90 9E 00 28 */	stw r4, 0x28(r30)
/* 803F5E70 003EBBF0  90 0D CE C0 */	stw r0, lbl_805A12E0-_SDA_BASE_(r13)
/* 803F5E74 003EBBF4  48 00 00 1C */	b lbl_803F5E90
lbl_803F5E78:
/* 803F5E78 003EBBF8  38 60 00 00 */	li r3, 0
/* 803F5E7C 003EBBFC  98 7E 00 09 */	stb r3, 9(r30)
/* 803F5E80 003EBC00  80 01 00 08 */	lwz r0, 8(r1)
/* 803F5E84 003EBC04  90 1E 00 18 */	stw r0, 0x18(r30)
/* 803F5E88 003EBC08  90 7E 00 28 */	stw r3, 0x28(r30)
lbl_803F5E8C:
/* 803F5E8C 003EBC0C  38 60 00 00 */	li r3, 0
lbl_803F5E90:
/* 803F5E90 003EBC10  80 01 00 24 */	lwz r0, 0x24(r1)
/* 803F5E94 003EBC14  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 803F5E98 003EBC18  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 803F5E9C 003EBC1C  7C 08 03 A6 */	mtlr r0
/* 803F5EA0 003EBC20  38 21 00 20 */	addi r1, r1, 0x20
/* 803F5EA4 003EBC24  4E 80 00 20 */	blr 

.global fseek
fseek:
/* 803F5EA8 003EBC28  4B FF FE 3C */	b _fseek

.global rewind
rewind:
/* 803F5EAC 003EBC2C  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 803F5EB0 003EBC30  7C 08 02 A6 */	mflr r0
/* 803F5EB4 003EBC34  38 80 00 00 */	li r4, 0
/* 803F5EB8 003EBC38  38 A0 00 00 */	li r5, 0
/* 803F5EBC 003EBC3C  90 01 00 14 */	stw r0, 0x14(r1)
/* 803F5EC0 003EBC40  93 E1 00 0C */	stw r31, 0xc(r1)
/* 803F5EC4 003EBC44  3B E0 00 00 */	li r31, 0
/* 803F5EC8 003EBC48  93 C1 00 08 */	stw r30, 8(r1)
/* 803F5ECC 003EBC4C  7C 7E 1B 78 */	mr r30, r3
/* 803F5ED0 003EBC50  9B E3 00 0A */	stb r31, 0xa(r3)
/* 803F5ED4 003EBC54  4B FF FE 11 */	bl _fseek
/* 803F5ED8 003EBC58  9B FE 00 0A */	stb r31, 0xa(r30)
/* 803F5EDC 003EBC5C  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 803F5EE0 003EBC60  83 C1 00 08 */	lwz r30, 8(r1)
/* 803F5EE4 003EBC64  80 01 00 14 */	lwz r0, 0x14(r1)
/* 803F5EE8 003EBC68  7C 08 03 A6 */	mtlr r0
/* 803F5EEC 003EBC6C  38 21 00 10 */	addi r1, r1, 0x10
/* 803F5EF0 003EBC70  4E 80 00 20 */	blr 

