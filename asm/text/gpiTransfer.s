.include "macros.inc"

.section .text, "ax"  # 0x8000C860 - 0x804064E0

.global gpiHandleTransferMessage
gpiHandleTransferMessage:
/* 80372BC4 00368944  94 21 FF 70 */	stwu r1, -0x90(r1)
/* 80372BC8 00368948  7C 08 02 A6 */	mflr r0
/* 80372BCC 0036894C  90 01 00 94 */	stw r0, 0x94(r1)
/* 80372BD0 00368950  38 A1 00 38 */	addi r5, r1, 0x38
/* 80372BD4 00368954  93 E1 00 8C */	stw r31, 0x8c(r1)
/* 80372BD8 00368958  93 C1 00 88 */	stw r30, 0x88(r1)
/* 80372BDC 0036895C  7C 9E 23 78 */	mr r30, r4
/* 80372BE0 00368960  38 8D B5 34 */	addi r4, r13, lbl_8059F954-_SDA_BASE_
/* 80372BE4 00368964  93 A1 00 84 */	stw r29, 0x84(r1)
/* 80372BE8 00368968  7C 7D 1B 78 */	mr r29, r3
/* 80372BEC 0036896C  7C C3 33 78 */	mr r3, r6
/* 80372BF0 00368970  38 C0 00 40 */	li r6, 0x40
/* 80372BF4 00368974  48 00 03 21 */	bl gpiValueForKey
/* 80372BF8 00368978  2C 03 00 00 */	cmpwi r3, 0
/* 80372BFC 0036897C  41 82 00 94 */	beq lbl_80372C90
/* 80372C00 00368980  3C 80 80 49 */	lis r4, lbl_8048FB10@ha
/* 80372C04 00368984  38 61 00 38 */	addi r3, r1, 0x38
/* 80372C08 00368988  38 84 FB 10 */	addi r4, r4, lbl_8048FB10@l
/* 80372C0C 0036898C  38 A1 00 08 */	addi r5, r1, 8
/* 80372C10 00368990  38 C1 00 0C */	addi r6, r1, 0xc
/* 80372C14 00368994  38 E1 00 10 */	addi r7, r1, 0x10
/* 80372C18 00368998  4C C6 31 82 */	crclr 6
/* 80372C1C 0036899C  48 08 74 ED */	bl sscanf
/* 80372C20 003689A0  2C 03 00 03 */	cmpwi r3, 3
/* 80372C24 003689A4  40 82 00 6C */	bne lbl_80372C90
/* 80372C28 003689A8  7F A3 EB 78 */	mr r3, r29
/* 80372C2C 003689AC  7F C4 F3 78 */	mr r4, r30
/* 80372C30 003689B0  38 C1 00 08 */	addi r6, r1, 8
/* 80372C34 003689B4  3B ED B5 30 */	addi r31, r13, lbl_8059F950-_SDA_BASE_
/* 80372C38 003689B8  38 A0 00 C9 */	li r5, 0xc9
/* 80372C3C 003689BC  4B FF D6 39 */	bl gpiPeerStartTransferMessage
/* 80372C40 003689C0  2C 03 00 00 */	cmpwi r3, 0
/* 80372C44 003689C4  40 82 00 4C */	bne lbl_80372C90
/* 80372C48 003689C8  3C 80 80 49 */	lis r4, lbl_8048FAF8@ha
/* 80372C4C 003689CC  38 61 00 18 */	addi r3, r1, 0x18
/* 80372C50 003689D0  38 84 FA F8 */	addi r4, r4, lbl_8048FAF8@l
/* 80372C54 003689D4  38 A0 00 01 */	li r5, 1
/* 80372C58 003689D8  38 C0 00 02 */	li r6, 2
/* 80372C5C 003689DC  4C C6 31 82 */	crclr 6
/* 80372C60 003689E0  48 08 5D 9D */	bl sprintf
/* 80372C64 003689E4  7F A3 EB 78 */	mr r3, r29
/* 80372C68 003689E8  7F C4 F3 78 */	mr r4, r30
/* 80372C6C 003689EC  38 A1 00 18 */	addi r5, r1, 0x18
/* 80372C70 003689F0  4B FF 7A 11 */	bl gpiSendOrBufferString
/* 80372C74 003689F4  2C 03 00 00 */	cmpwi r3, 0
/* 80372C78 003689F8  40 82 00 18 */	bne lbl_80372C90
/* 80372C7C 003689FC  7F A3 EB 78 */	mr r3, r29
/* 80372C80 00368A00  7F C4 F3 78 */	mr r4, r30
/* 80372C84 00368A04  7F E5 FB 78 */	mr r5, r31
/* 80372C88 00368A08  38 C0 FF FF */	li r6, -1
/* 80372C8C 00368A0C  4B FF D6 51 */	bl gpiPeerFinishTransferMessage
lbl_80372C90:
/* 80372C90 00368A10  80 01 00 94 */	lwz r0, 0x94(r1)
/* 80372C94 00368A14  83 E1 00 8C */	lwz r31, 0x8c(r1)
/* 80372C98 00368A18  83 C1 00 88 */	lwz r30, 0x88(r1)
/* 80372C9C 00368A1C  83 A1 00 84 */	lwz r29, 0x84(r1)
/* 80372CA0 00368A20  7C 08 03 A6 */	mtlr r0
/* 80372CA4 00368A24  38 21 00 90 */	addi r1, r1, 0x90
/* 80372CA8 00368A28  4E 80 00 20 */	blr 

