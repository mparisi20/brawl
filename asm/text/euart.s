.include "macros.inc"

.section .text, "ax"  # 0x8000C860 - 0x804064E0

.global EUARTInit
EUARTInit:
/* 802284C4 0021E244  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 802284C8 0021E248  7C 08 02 A6 */	mflr r0
/* 802284CC 0021E24C  90 01 00 24 */	stw r0, 0x24(r1)
/* 802284D0 0021E250  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 802284D4 0021E254  80 0D C8 A0 */	lwz r0, lbl_805A0CC0-_SDA_BASE_(r13)
/* 802284D8 0021E258  2C 00 00 00 */	cmpwi r0, 0
/* 802284DC 0021E25C  41 82 00 0C */	beq lbl_802284E8
/* 802284E0 0021E260  38 60 00 01 */	li r3, 1
/* 802284E4 0021E264  48 00 00 C8 */	b lbl_802285AC
lbl_802284E8:
/* 802284E8 0021E268  4B FA CE 85 */	bl OSGetConsoleType
/* 802284EC 0021E26C  54 60 00 C7 */	rlwinm. r0, r3, 0, 3, 3
/* 802284F0 0021E270  40 82 00 14 */	bne lbl_80228504
/* 802284F4 0021E274  38 00 00 02 */	li r0, 2
/* 802284F8 0021E278  38 60 00 00 */	li r3, 0
/* 802284FC 0021E27C  90 0D C8 A4 */	stw r0, lbl_805A0CC4-_SDA_BASE_(r13)
/* 80228500 0021E280  48 00 00 AC */	b lbl_802285AC
lbl_80228504:
/* 80228504 0021E284  4B FB 4A 0D */	bl OSDisableInterrupts
/* 80228508 0021E288  38 00 00 F2 */	li r0, 0xf2
/* 8022850C 0021E28C  7C 7F 1B 78 */	mr r31, r3
/* 80228510 0021E290  98 01 00 08 */	stb r0, 8(r1)
/* 80228514 0021E294  38 C1 00 08 */	addi r6, r1, 8
/* 80228518 0021E298  38 60 00 00 */	li r3, 0
/* 8022851C 0021E29C  38 80 00 01 */	li r4, 1
/* 80228520 0021E2A0  3C A0 B0 00 */	lis r5, 0xb000
/* 80228524 0021E2A4  38 E0 00 01 */	li r7, 1
/* 80228528 0021E2A8  4B FB D8 95 */	bl EXIWriteReg
/* 8022852C 0021E2AC  2C 03 00 00 */	cmpwi r3, 0
/* 80228530 0021E2B0  40 82 00 1C */	bne lbl_8022854C
/* 80228534 0021E2B4  38 00 00 05 */	li r0, 5
/* 80228538 0021E2B8  7F E3 FB 78 */	mr r3, r31
/* 8022853C 0021E2BC  90 0D C8 A4 */	stw r0, lbl_805A0CC4-_SDA_BASE_(r13)
/* 80228540 0021E2C0  4B FB 49 F9 */	bl OSRestoreInterrupts
/* 80228544 0021E2C4  38 60 00 00 */	li r3, 0
/* 80228548 0021E2C8  48 00 00 64 */	b lbl_802285AC
lbl_8022854C:
/* 8022854C 0021E2CC  38 00 00 F3 */	li r0, 0xf3
/* 80228550 0021E2D0  38 C1 00 08 */	addi r6, r1, 8
/* 80228554 0021E2D4  98 01 00 08 */	stb r0, 8(r1)
/* 80228558 0021E2D8  38 60 00 00 */	li r3, 0
/* 8022855C 0021E2DC  38 80 00 01 */	li r4, 1
/* 80228560 0021E2E0  3C A0 B0 00 */	lis r5, 0xb000
/* 80228564 0021E2E4  38 E0 00 01 */	li r7, 1
/* 80228568 0021E2E8  4B FB D8 55 */	bl EXIWriteReg
/* 8022856C 0021E2EC  2C 03 00 00 */	cmpwi r3, 0
/* 80228570 0021E2F0  40 82 00 1C */	bne lbl_8022858C
/* 80228574 0021E2F4  38 00 00 05 */	li r0, 5
/* 80228578 0021E2F8  7F E3 FB 78 */	mr r3, r31
/* 8022857C 0021E2FC  90 0D C8 A4 */	stw r0, lbl_805A0CC4-_SDA_BASE_(r13)
/* 80228580 0021E300  4B FB 49 B9 */	bl OSRestoreInterrupts
/* 80228584 0021E304  38 60 00 00 */	li r3, 0
/* 80228588 0021E308  48 00 00 24 */	b lbl_802285AC
lbl_8022858C:
/* 8022858C 0021E30C  7F E3 FB 78 */	mr r3, r31
/* 80228590 0021E310  4B FB 49 A9 */	bl OSRestoreInterrupts
/* 80228594 0021E314  38 00 00 00 */	li r0, 0
/* 80228598 0021E318  38 60 00 01 */	li r3, 1
/* 8022859C 0021E31C  90 6D C8 A0 */	stw r3, lbl_805A0CC0-_SDA_BASE_(r13)
/* 802285A0 0021E320  38 60 00 01 */	li r3, 1
/* 802285A4 0021E324  90 0D C8 A4 */	stw r0, lbl_805A0CC4-_SDA_BASE_(r13)
/* 802285A8 0021E328  90 0D C8 A8 */	stw r0, lbl_805A0CC8-_SDA_BASE_(r13)
lbl_802285AC:
/* 802285AC 0021E32C  80 01 00 24 */	lwz r0, 0x24(r1)
/* 802285B0 0021E330  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 802285B4 0021E334  7C 08 03 A6 */	mtlr r0
/* 802285B8 0021E338  38 21 00 20 */	addi r1, r1, 0x20
/* 802285BC 0021E33C  4E 80 00 20 */	blr 

.global InitializeUART
InitializeUART:
/* 802285C0 0021E340  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 802285C4 0021E344  7C 08 02 A6 */	mflr r0
/* 802285C8 0021E348  90 01 00 14 */	stw r0, 0x14(r1)
/* 802285CC 0021E34C  4B FA CD A1 */	bl OSGetConsoleType
/* 802285D0 0021E350  54 60 00 C7 */	rlwinm. r0, r3, 0, 3, 3
/* 802285D4 0021E354  40 82 00 14 */	bne lbl_802285E8
/* 802285D8 0021E358  38 00 00 00 */	li r0, 0
/* 802285DC 0021E35C  38 60 00 02 */	li r3, 2
/* 802285E0 0021E360  90 0D C8 AC */	stw r0, lbl_805A0CCC-_SDA_BASE_(r13)
/* 802285E4 0021E364  48 00 00 14 */	b lbl_802285F8
lbl_802285E8:
/* 802285E8 0021E368  3C 80 A5 FF */	lis r4, 0xA5FF005A@ha
/* 802285EC 0021E36C  38 60 00 00 */	li r3, 0
/* 802285F0 0021E370  38 04 00 5A */	addi r0, r4, 0xA5FF005A@l
/* 802285F4 0021E374  90 0D C8 AC */	stw r0, lbl_805A0CCC-_SDA_BASE_(r13)
lbl_802285F8:
/* 802285F8 0021E378  80 01 00 14 */	lwz r0, 0x14(r1)
/* 802285FC 0021E37C  7C 08 03 A6 */	mtlr r0
/* 80228600 0021E380  38 21 00 10 */	addi r1, r1, 0x10
/* 80228604 0021E384  4E 80 00 20 */	blr 

.global WriteUARTN
WriteUARTN:
/* 80228608 0021E388  94 21 FF D0 */	stwu r1, -0x30(r1)
/* 8022860C 0021E38C  7C 08 02 A6 */	mflr r0
/* 80228610 0021E390  90 01 00 34 */	stw r0, 0x34(r1)
/* 80228614 0021E394  39 61 00 30 */	addi r11, r1, 0x30
/* 80228618 0021E398  48 1C 8D 05 */	bl _savegpr_26
/* 8022861C 0021E39C  80 AD C8 AC */	lwz r5, lbl_805A0CCC-_SDA_BASE_(r13)
/* 80228620 0021E3A0  7C 7E 1B 78 */	mr r30, r3
/* 80228624 0021E3A4  7C 9F 23 78 */	mr r31, r4
/* 80228628 0021E3A8  3C 05 5A 01 */	addis r0, r5, 0x5a01
/* 8022862C 0021E3AC  28 00 00 5A */	cmplwi r0, 0x5a
/* 80228630 0021E3B0  41 82 00 0C */	beq lbl_8022863C
/* 80228634 0021E3B4  38 60 00 02 */	li r3, 2
/* 80228638 0021E3B8  48 00 01 E4 */	b lbl_8022881C
lbl_8022863C:
/* 8022863C 0021E3BC  80 0D C8 A0 */	lwz r0, lbl_805A0CC0-_SDA_BASE_(r13)
/* 80228640 0021E3C0  2C 00 00 00 */	cmpwi r0, 0
/* 80228644 0021E3C4  40 82 00 18 */	bne lbl_8022865C
/* 80228648 0021E3C8  4B FF FE 7D */	bl EUARTInit
/* 8022864C 0021E3CC  2C 03 00 00 */	cmpwi r3, 0
/* 80228650 0021E3D0  40 82 00 0C */	bne lbl_8022865C
/* 80228654 0021E3D4  38 60 00 02 */	li r3, 2
/* 80228658 0021E3D8  48 00 01 C4 */	b lbl_8022881C
lbl_8022865C:
/* 8022865C 0021E3DC  80 0D C8 A0 */	lwz r0, lbl_805A0CC0-_SDA_BASE_(r13)
/* 80228660 0021E3E0  2C 00 00 00 */	cmpwi r0, 0
/* 80228664 0021E3E4  40 82 00 14 */	bne lbl_80228678
/* 80228668 0021E3E8  38 00 00 01 */	li r0, 1
/* 8022866C 0021E3EC  38 60 00 02 */	li r3, 2
/* 80228670 0021E3F0  90 0D C8 A4 */	stw r0, lbl_805A0CC4-_SDA_BASE_(r13)
/* 80228674 0021E3F4  48 00 01 A8 */	b lbl_8022881C
lbl_80228678:
/* 80228678 0021E3F8  38 60 00 00 */	li r3, 0
/* 8022867C 0021E3FC  38 80 00 01 */	li r4, 1
/* 80228680 0021E400  38 A0 00 00 */	li r5, 0
/* 80228684 0021E404  4B FB CE 5D */	bl EXILock
/* 80228688 0021E408  2C 03 00 00 */	cmpwi r3, 0
/* 8022868C 0021E40C  40 82 00 0C */	bne lbl_80228698
/* 80228690 0021E410  38 60 00 00 */	li r3, 0
/* 80228694 0021E414  48 00 01 88 */	b lbl_8022881C
lbl_80228698:
/* 80228698 0021E418  7F C4 F3 78 */	mr r4, r30
/* 8022869C 0021E41C  38 60 00 0D */	li r3, 0xd
/* 802286A0 0021E420  48 00 00 18 */	b lbl_802286B8
lbl_802286A4:
/* 802286A4 0021E424  88 04 00 00 */	lbz r0, 0(r4)
/* 802286A8 0021E428  2C 00 00 0A */	cmpwi r0, 0xa
/* 802286AC 0021E42C  40 82 00 08 */	bne lbl_802286B4
/* 802286B0 0021E430  98 64 00 00 */	stb r3, 0(r4)
lbl_802286B4:
/* 802286B4 0021E434  38 84 00 01 */	addi r4, r4, 1
lbl_802286B8:
/* 802286B8 0021E438  7C 1E 20 50 */	subf r0, r30, r4
/* 802286BC 0021E43C  7C 00 F8 40 */	cmplw r0, r31
/* 802286C0 0021E440  41 80 FF E4 */	blt lbl_802286A4
/* 802286C4 0021E444  3C 60 B0 00 */	lis r3, 0xB0000100@ha
/* 802286C8 0021E448  83 82 A4 30 */	lwz r28, lbl_805A3750-_SDA2_BASE_(r2)
/* 802286CC 0021E44C  38 03 01 00 */	addi r0, r3, 0xB0000100@l
/* 802286D0 0021E450  3B 40 00 00 */	li r26, 0
/* 802286D4 0021E454  90 01 00 14 */	stw r0, 0x14(r1)
/* 802286D8 0021E458  3F A0 30 00 */	lis r29, 0x3000
/* 802286DC 0021E45C  48 00 01 2C */	b lbl_80228808
lbl_802286E0:
/* 802286E0 0021E460  7F 85 E3 78 */	mr r5, r28
/* 802286E4 0021E464  38 60 00 00 */	li r3, 0
/* 802286E8 0021E468  38 80 00 01 */	li r4, 1
/* 802286EC 0021E46C  4B FB C6 61 */	bl EXISelect
/* 802286F0 0021E470  2C 03 00 00 */	cmpwi r3, 0
/* 802286F4 0021E474  40 82 00 0C */	bne lbl_80228700
/* 802286F8 0021E478  3B 60 FF FF */	li r27, -1
/* 802286FC 0021E47C  48 00 00 60 */	b lbl_8022875C
lbl_80228700:
/* 80228700 0021E480  38 1D 01 00 */	addi r0, r29, 0x100
/* 80228704 0021E484  38 81 00 08 */	addi r4, r1, 8
/* 80228708 0021E488  90 01 00 08 */	stw r0, 8(r1)
/* 8022870C 0021E48C  38 60 00 00 */	li r3, 0
/* 80228710 0021E490  38 A0 00 04 */	li r5, 4
/* 80228714 0021E494  38 C0 00 01 */	li r6, 1
/* 80228718 0021E498  38 E0 00 00 */	li r7, 0
/* 8022871C 0021E49C  4B FB BB C9 */	bl EXIImm
/* 80228720 0021E4A0  38 60 00 00 */	li r3, 0
/* 80228724 0021E4A4  4B FB BF D9 */	bl EXISync
/* 80228728 0021E4A8  38 81 00 0C */	addi r4, r1, 0xc
/* 8022872C 0021E4AC  38 60 00 00 */	li r3, 0
/* 80228730 0021E4B0  38 A0 00 04 */	li r5, 4
/* 80228734 0021E4B4  38 C0 00 00 */	li r6, 0
/* 80228738 0021E4B8  38 E0 00 00 */	li r7, 0
/* 8022873C 0021E4BC  4B FB BB A9 */	bl EXIImm
/* 80228740 0021E4C0  38 60 00 00 */	li r3, 0
/* 80228744 0021E4C4  4B FB BF B9 */	bl EXISync
/* 80228748 0021E4C8  38 60 00 00 */	li r3, 0
/* 8022874C 0021E4CC  4B FB C7 31 */	bl EXIDeselect
/* 80228750 0021E4D0  80 01 00 0C */	lwz r0, 0xc(r1)
/* 80228754 0021E4D4  54 00 46 BE */	rlwinm r0, r0, 8, 0x1a, 0x1f
/* 80228758 0021E4D8  23 60 00 20 */	subfic r27, r0, 0x20
lbl_8022875C:
/* 8022875C 0021E4DC  2C 1B 00 00 */	cmpwi r27, 0
/* 80228760 0021E4E0  40 80 00 0C */	bge lbl_8022876C
/* 80228764 0021E4E4  3B 40 00 03 */	li r26, 3
/* 80228768 0021E4E8  48 00 00 A8 */	b lbl_80228810
lbl_8022876C:
/* 8022876C 0021E4EC  2C 1B 00 20 */	cmpwi r27, 0x20
/* 80228770 0021E4F0  40 82 00 98 */	bne lbl_80228808
/* 80228774 0021E4F4  7F 85 E3 78 */	mr r5, r28
/* 80228778 0021E4F8  38 60 00 00 */	li r3, 0
/* 8022877C 0021E4FC  38 80 00 01 */	li r4, 1
/* 80228780 0021E500  4B FB C5 CD */	bl EXISelect
/* 80228784 0021E504  2C 03 00 00 */	cmpwi r3, 0
/* 80228788 0021E508  40 82 00 0C */	bne lbl_80228794
/* 8022878C 0021E50C  3B 40 00 03 */	li r26, 3
/* 80228790 0021E510  48 00 00 80 */	b lbl_80228810
lbl_80228794:
/* 80228794 0021E514  38 81 00 14 */	addi r4, r1, 0x14
/* 80228798 0021E518  38 60 00 00 */	li r3, 0
/* 8022879C 0021E51C  38 A0 00 04 */	li r5, 4
/* 802287A0 0021E520  38 C0 00 01 */	li r6, 1
/* 802287A4 0021E524  38 E0 00 00 */	li r7, 0
/* 802287A8 0021E528  4B FB BB 3D */	bl EXIImm
/* 802287AC 0021E52C  38 60 00 00 */	li r3, 0
/* 802287B0 0021E530  4B FB BF 4D */	bl EXISync
/* 802287B4 0021E534  48 00 00 3C */	b lbl_802287F0
lbl_802287B8:
/* 802287B8 0021E538  88 1E 00 00 */	lbz r0, 0(r30)
/* 802287BC 0021E53C  38 81 00 10 */	addi r4, r1, 0x10
/* 802287C0 0021E540  38 60 00 00 */	li r3, 0
/* 802287C4 0021E544  38 A0 00 04 */	li r5, 4
/* 802287C8 0021E548  54 00 C0 0E */	slwi r0, r0, 0x18
/* 802287CC 0021E54C  38 C0 00 01 */	li r6, 1
/* 802287D0 0021E550  90 01 00 10 */	stw r0, 0x10(r1)
/* 802287D4 0021E554  38 E0 00 00 */	li r7, 0
/* 802287D8 0021E558  4B FB BB 0D */	bl EXIImm
/* 802287DC 0021E55C  38 60 00 00 */	li r3, 0
/* 802287E0 0021E560  4B FB BF 1D */	bl EXISync
/* 802287E4 0021E564  3B DE 00 01 */	addi r30, r30, 1
/* 802287E8 0021E568  3B 7B FF FF */	addi r27, r27, -1
/* 802287EC 0021E56C  3B FF FF FF */	addi r31, r31, -1
lbl_802287F0:
/* 802287F0 0021E570  2C 1B 00 00 */	cmpwi r27, 0
/* 802287F4 0021E574  40 81 00 0C */	ble lbl_80228800
/* 802287F8 0021E578  2C 1F 00 00 */	cmpwi r31, 0
/* 802287FC 0021E57C  40 82 FF BC */	bne lbl_802287B8
lbl_80228800:
/* 80228800 0021E580  38 60 00 00 */	li r3, 0
/* 80228804 0021E584  4B FB C6 79 */	bl EXIDeselect
lbl_80228808:
/* 80228808 0021E588  2C 1F 00 00 */	cmpwi r31, 0
/* 8022880C 0021E58C  40 82 FE D4 */	bne lbl_802286E0
lbl_80228810:
/* 80228810 0021E590  38 60 00 00 */	li r3, 0
/* 80228814 0021E594  4B FB CD C9 */	bl EXIUnlock
/* 80228818 0021E598  7F 43 D3 78 */	mr r3, r26
lbl_8022881C:
/* 8022881C 0021E59C  39 61 00 30 */	addi r11, r1, 0x30
/* 80228820 0021E5A0  48 1C 8B 49 */	bl _restgpr_26
/* 80228824 0021E5A4  80 01 00 34 */	lwz r0, 0x34(r1)
/* 80228828 0021E5A8  7C 08 03 A6 */	mtlr r0
/* 8022882C 0021E5AC  38 21 00 30 */	addi r1, r1, 0x30
/* 80228830 0021E5B0  4E 80 00 20 */	blr 

