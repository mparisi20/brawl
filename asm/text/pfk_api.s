.include "macros.inc"

.section .text, "ax"  # 0x8000C860 - 0x804064E0

.global pfk_get_task_id
pfk_get_task_id:
/* 803EC27C 003E1FFC  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 803EC280 003E2000  7C 08 02 A6 */	mflr r0
/* 803EC284 003E2004  2C 03 00 00 */	cmpwi r3, 0
/* 803EC288 003E2008  90 01 00 14 */	stw r0, 0x14(r1)
/* 803EC28C 003E200C  93 E1 00 0C */	stw r31, 0xc(r1)
/* 803EC290 003E2010  7C 7F 1B 78 */	mr r31, r3
/* 803EC294 003E2014  40 82 00 1C */	bne lbl_803EC2B0
/* 803EC298 003E2018  3C 60 80 49 */	lis r3, lbl_804930A0@ha
/* 803EC29C 003E201C  38 63 30 A0 */	addi r3, r3, lbl_804930A0@l
/* 803EC2A0 003E2020  4C C6 31 82 */	crclr 6
/* 803EC2A4 003E2024  4B DE C3 5D */	bl OSReport
/* 803EC2A8 003E2028  38 60 FF FE */	li r3, -2
/* 803EC2AC 003E202C  48 00 00 38 */	b lbl_803EC2E4
lbl_803EC2B0:
/* 803EC2B0 003E2030  4B DF 44 65 */	bl OSGetCurrentThread
/* 803EC2B4 003E2034  2C 03 00 00 */	cmpwi r3, 0
/* 803EC2B8 003E2038  40 82 00 24 */	bne lbl_803EC2DC
/* 803EC2BC 003E203C  3C 60 80 49 */	lis r3, lbl_804930D0@ha
/* 803EC2C0 003E2040  38 63 30 D0 */	addi r3, r3, lbl_804930D0@l
/* 803EC2C4 003E2044  4C C6 31 82 */	crclr 6
/* 803EC2C8 003E2048  4B DE C3 39 */	bl OSReport
/* 803EC2CC 003E204C  38 00 00 00 */	li r0, 0
/* 803EC2D0 003E2050  38 60 FF FD */	li r3, -3
/* 803EC2D4 003E2054  90 1F 00 00 */	stw r0, 0(r31)
/* 803EC2D8 003E2058  48 00 00 0C */	b lbl_803EC2E4
lbl_803EC2DC:
/* 803EC2DC 003E205C  90 7F 00 00 */	stw r3, 0(r31)
/* 803EC2E0 003E2060  38 60 00 00 */	li r3, 0
lbl_803EC2E4:
/* 803EC2E4 003E2064  80 01 00 14 */	lwz r0, 0x14(r1)
/* 803EC2E8 003E2068  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 803EC2EC 003E206C  7C 08 03 A6 */	mtlr r0
/* 803EC2F0 003E2070  38 21 00 10 */	addi r1, r1, 0x10
/* 803EC2F4 003E2074  4E 80 00 20 */	blr 

.global pfk_create_semaphore
pfk_create_semaphore:
/* 803EC2F8 003E2078  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 803EC2FC 003E207C  7C 08 02 A6 */	mflr r0
/* 803EC300 003E2080  2C 03 00 00 */	cmpwi r3, 0
/* 803EC304 003E2084  90 01 00 14 */	stw r0, 0x14(r1)
/* 803EC308 003E2088  93 E1 00 0C */	stw r31, 0xc(r1)
/* 803EC30C 003E208C  93 C1 00 08 */	stw r30, 8(r1)
/* 803EC310 003E2090  7C 7E 1B 78 */	mr r30, r3
/* 803EC314 003E2094  41 82 00 20 */	beq lbl_803EC334
/* 803EC318 003E2098  80 A3 00 08 */	lwz r5, 8(r3)
/* 803EC31C 003E209C  2C 05 00 00 */	cmpwi r5, 0
/* 803EC320 003E20A0  41 82 00 14 */	beq lbl_803EC334
/* 803EC324 003E20A4  80 83 00 04 */	lwz r4, 4(r3)
/* 803EC328 003E20A8  80 03 00 00 */	lwz r0, 0(r3)
/* 803EC32C 003E20AC  7C 00 20 40 */	cmplw r0, r4
/* 803EC330 003E20B0  40 81 00 1C */	ble lbl_803EC34C
lbl_803EC334:
/* 803EC334 003E20B4  3C 60 80 49 */	lis r3, lbl_804930F4@ha
/* 803EC338 003E20B8  38 63 30 F4 */	addi r3, r3, lbl_804930F4@l
/* 803EC33C 003E20BC  4C C6 31 82 */	crclr 6
/* 803EC340 003E20C0  4B DE C2 C1 */	bl OSReport
/* 803EC344 003E20C4  38 60 00 00 */	li r3, 0
/* 803EC348 003E20C8  48 00 00 34 */	b lbl_803EC37C
lbl_803EC34C:
/* 803EC34C 003E20CC  7C A3 2B 78 */	mr r3, r5
/* 803EC350 003E20D0  4B DF 3F 85 */	bl OSInitSemaphore
/* 803EC354 003E20D4  80 7E 00 00 */	lwz r3, 0(r30)
/* 803EC358 003E20D8  80 1E 00 04 */	lwz r0, 4(r30)
/* 803EC35C 003E20DC  7F E3 00 50 */	subf r31, r3, r0
/* 803EC360 003E20E0  48 00 00 10 */	b lbl_803EC370
lbl_803EC364:
/* 803EC364 003E20E4  80 7E 00 08 */	lwz r3, 8(r30)
/* 803EC368 003E20E8  4B DF 3F C5 */	bl OSWaitSemaphore
/* 803EC36C 003E20EC  3B FF FF FF */	addi r31, r31, -1
lbl_803EC370:
/* 803EC370 003E20F0  2C 1F 00 00 */	cmpwi r31, 0
/* 803EC374 003E20F4  40 82 FF F0 */	bne lbl_803EC364
/* 803EC378 003E20F8  80 7E 00 08 */	lwz r3, 8(r30)
lbl_803EC37C:
/* 803EC37C 003E20FC  80 01 00 14 */	lwz r0, 0x14(r1)
/* 803EC380 003E2100  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 803EC384 003E2104  83 C1 00 08 */	lwz r30, 8(r1)
/* 803EC388 003E2108  7C 08 03 A6 */	mtlr r0
/* 803EC38C 003E210C  38 21 00 10 */	addi r1, r1, 0x10
/* 803EC390 003E2110  4E 80 00 20 */	blr 

.global pfk_delete_semaphore
pfk_delete_semaphore:
/* 803EC394 003E2114  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 803EC398 003E2118  7C 08 02 A6 */	mflr r0
/* 803EC39C 003E211C  2C 03 00 00 */	cmpwi r3, 0
/* 803EC3A0 003E2120  90 01 00 14 */	stw r0, 0x14(r1)
/* 803EC3A4 003E2124  40 82 00 1C */	bne lbl_803EC3C0
/* 803EC3A8 003E2128  3C 60 80 49 */	lis r3, lbl_80493128@ha
/* 803EC3AC 003E212C  38 63 31 28 */	addi r3, r3, lbl_80493128@l
/* 803EC3B0 003E2130  4C C6 31 82 */	crclr 6
/* 803EC3B4 003E2134  4B DE C2 4D */	bl OSReport
/* 803EC3B8 003E2138  38 60 FF FE */	li r3, -2
/* 803EC3BC 003E213C  48 00 00 08 */	b lbl_803EC3C4
lbl_803EC3C0:
/* 803EC3C0 003E2140  38 60 00 00 */	li r3, 0
lbl_803EC3C4:
/* 803EC3C4 003E2144  80 01 00 14 */	lwz r0, 0x14(r1)
/* 803EC3C8 003E2148  7C 08 03 A6 */	mtlr r0
/* 803EC3CC 003E214C  38 21 00 10 */	addi r1, r1, 0x10
/* 803EC3D0 003E2150  4E 80 00 20 */	blr 

.global pfk_get_semaphore
pfk_get_semaphore:
/* 803EC3D4 003E2154  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 803EC3D8 003E2158  7C 08 02 A6 */	mflr r0
/* 803EC3DC 003E215C  2C 03 00 00 */	cmpwi r3, 0
/* 803EC3E0 003E2160  90 01 00 14 */	stw r0, 0x14(r1)
/* 803EC3E4 003E2164  40 82 00 1C */	bne lbl_803EC400
/* 803EC3E8 003E2168  3C 60 80 49 */	lis r3, lbl_8049315C@ha
/* 803EC3EC 003E216C  38 63 31 5C */	addi r3, r3, lbl_8049315C@l
/* 803EC3F0 003E2170  4C C6 31 82 */	crclr 6
/* 803EC3F4 003E2174  4B DE C2 0D */	bl OSReport
/* 803EC3F8 003E2178  38 60 FF FE */	li r3, -2
/* 803EC3FC 003E217C  48 00 00 0C */	b lbl_803EC408
lbl_803EC400:
/* 803EC400 003E2180  4B DF 3F 2D */	bl OSWaitSemaphore
/* 803EC404 003E2184  38 60 00 00 */	li r3, 0
lbl_803EC408:
/* 803EC408 003E2188  80 01 00 14 */	lwz r0, 0x14(r1)
/* 803EC40C 003E218C  7C 08 03 A6 */	mtlr r0
/* 803EC410 003E2190  38 21 00 10 */	addi r1, r1, 0x10
/* 803EC414 003E2194  4E 80 00 20 */	blr 

.global pfk_release_semaphore
pfk_release_semaphore:
/* 803EC418 003E2198  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 803EC41C 003E219C  7C 08 02 A6 */	mflr r0
/* 803EC420 003E21A0  2C 03 00 00 */	cmpwi r3, 0
/* 803EC424 003E21A4  90 01 00 14 */	stw r0, 0x14(r1)
/* 803EC428 003E21A8  40 82 00 1C */	bne lbl_803EC444
/* 803EC42C 003E21AC  3C 60 80 49 */	lis r3, lbl_8049318C@ha
/* 803EC430 003E21B0  38 63 31 8C */	addi r3, r3, lbl_8049318C@l
/* 803EC434 003E21B4  4C C6 31 82 */	crclr 6
/* 803EC438 003E21B8  4B DE C1 C9 */	bl OSReport
/* 803EC43C 003E21BC  38 60 FF FE */	li r3, -2
/* 803EC440 003E21C0  48 00 00 0C */	b lbl_803EC44C
lbl_803EC444:
/* 803EC444 003E21C4  4B DF 3F 59 */	bl OSSignalSemaphore
/* 803EC448 003E21C8  38 60 00 00 */	li r3, 0
lbl_803EC44C:
/* 803EC44C 003E21CC  80 01 00 14 */	lwz r0, 0x14(r1)
/* 803EC450 003E21D0  7C 08 03 A6 */	mtlr r0
/* 803EC454 003E21D4  38 21 00 10 */	addi r1, r1, 0x10
/* 803EC458 003E21D8  4E 80 00 20 */	blr 

