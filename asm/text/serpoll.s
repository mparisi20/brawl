.include "macros.inc"

.section .text, "ax"  # 0x8000C860 - 0x804064E0

.global TRKTerminateSerialHandler
TRKTerminateSerialHandler:
/* 80401AA4 003F7824  38 60 00 00 */	li r3, 0
/* 80401AA8 003F7828  4E 80 00 20 */	blr 

.global TRKInitializeSerialHandler
TRKInitializeSerialHandler:
/* 80401AAC 003F782C  3C 60 80 5A */	lis r3, lbl_8059B928@ha
/* 80401AB0 003F7830  38 A0 FF FF */	li r5, -1
/* 80401AB4 003F7834  38 83 B9 28 */	addi r4, r3, lbl_8059B928@l
/* 80401AB8 003F7838  38 00 00 00 */	li r0, 0
/* 80401ABC 003F783C  90 A4 00 00 */	stw r5, 0(r4)
/* 80401AC0 003F7840  38 60 00 00 */	li r3, 0
/* 80401AC4 003F7844  90 04 00 08 */	stw r0, 8(r4)
/* 80401AC8 003F7848  90 04 00 0C */	stw r0, 0xc(r4)
/* 80401ACC 003F784C  4E 80 00 20 */	blr 

.global TRKProcessInput
TRKProcessInput:
/* 80401AD0 003F7850  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 80401AD4 003F7854  7C 08 02 A6 */	mflr r0
/* 80401AD8 003F7858  38 80 00 02 */	li r4, 2
/* 80401ADC 003F785C  90 01 00 24 */	stw r0, 0x24(r1)
/* 80401AE0 003F7860  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 80401AE4 003F7864  7C 7F 1B 78 */	mr r31, r3
/* 80401AE8 003F7868  38 61 00 08 */	addi r3, r1, 8
/* 80401AEC 003F786C  4B FF F3 C9 */	bl TRKConstructEvent
/* 80401AF0 003F7870  3C 60 80 5A */	lis r3, lbl_8059B928@ha
/* 80401AF4 003F7874  38 00 FF FF */	li r0, -1
/* 80401AF8 003F7878  38 83 B9 28 */	addi r4, r3, lbl_8059B928@l
/* 80401AFC 003F787C  93 E1 00 10 */	stw r31, 0x10(r1)
/* 80401B00 003F7880  38 61 00 08 */	addi r3, r1, 8
/* 80401B04 003F7884  90 04 00 00 */	stw r0, 0(r4)
/* 80401B08 003F7888  4B FF F3 C5 */	bl TRKPostEvent
/* 80401B0C 003F788C  80 01 00 24 */	lwz r0, 0x24(r1)
/* 80401B10 003F7890  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 80401B14 003F7894  7C 08 03 A6 */	mtlr r0
/* 80401B18 003F7898  38 21 00 20 */	addi r1, r1, 0x20
/* 80401B1C 003F789C  4E 80 00 20 */	blr 

.global TRKGetInput
TRKGetInput:
/* 80401B20 003F78A0  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 80401B24 003F78A4  7C 08 02 A6 */	mflr r0
/* 80401B28 003F78A8  90 01 00 24 */	stw r0, 0x24(r1)
/* 80401B2C 003F78AC  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 80401B30 003F78B0  48 00 00 51 */	bl TRKTestForPacket
/* 80401B34 003F78B4  7C 7F 1B 78 */	mr r31, r3
/* 80401B38 003F78B8  2C 1F FF FF */	cmpwi r31, -1
/* 80401B3C 003F78BC  41 82 00 30 */	beq lbl_80401B6C
/* 80401B40 003F78C0  4B FF FD FD */	bl TRKGetBuffer
/* 80401B44 003F78C4  38 61 00 08 */	addi r3, r1, 8
/* 80401B48 003F78C8  38 80 00 02 */	li r4, 2
/* 80401B4C 003F78CC  4B FF F3 69 */	bl TRKConstructEvent
/* 80401B50 003F78D0  3C 60 80 5A */	lis r3, lbl_8059B928@ha
/* 80401B54 003F78D4  38 00 FF FF */	li r0, -1
/* 80401B58 003F78D8  38 83 B9 28 */	addi r4, r3, lbl_8059B928@l
/* 80401B5C 003F78DC  93 E1 00 10 */	stw r31, 0x10(r1)
/* 80401B60 003F78E0  38 61 00 08 */	addi r3, r1, 8
/* 80401B64 003F78E4  90 04 00 00 */	stw r0, 0(r4)
/* 80401B68 003F78E8  4B FF F3 65 */	bl TRKPostEvent
lbl_80401B6C:
/* 80401B6C 003F78EC  80 01 00 24 */	lwz r0, 0x24(r1)
/* 80401B70 003F78F0  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 80401B74 003F78F4  7C 08 03 A6 */	mtlr r0
/* 80401B78 003F78F8  38 21 00 20 */	addi r1, r1, 0x20
/* 80401B7C 003F78FC  4E 80 00 20 */	blr 

.global TRKTestForPacket
TRKTestForPacket:
/* 80401B80 003F7900  94 21 F7 20 */	stwu r1, -0x8e0(r1)
/* 80401B84 003F7904  7C 08 02 A6 */	mflr r0
/* 80401B88 003F7908  90 01 08 E4 */	stw r0, 0x8e4(r1)
/* 80401B8C 003F790C  93 E1 08 DC */	stw r31, 0x8dc(r1)
/* 80401B90 003F7910  48 00 40 55 */	bl TRKPollUART
/* 80401B94 003F7914  2C 03 00 00 */	cmpwi r3, 0
/* 80401B98 003F7918  41 81 00 0C */	bgt lbl_80401BA4
/* 80401B9C 003F791C  38 60 FF FF */	li r3, -1
/* 80401BA0 003F7920  48 00 00 9C */	b lbl_80401C3C
lbl_80401BA4:
/* 80401BA4 003F7924  38 61 00 0C */	addi r3, r1, 0xc
/* 80401BA8 003F7928  38 81 00 08 */	addi r4, r1, 8
/* 80401BAC 003F792C  4B FF FD BD */	bl TRKGetFreeBuffer
/* 80401BB0 003F7930  7C 60 1B 78 */	mr r0, r3
/* 80401BB4 003F7934  80 61 00 08 */	lwz r3, 8(r1)
/* 80401BB8 003F7938  7C 1F 03 78 */	mr r31, r0
/* 80401BBC 003F793C  38 80 00 00 */	li r4, 0
/* 80401BC0 003F7940  4B FF FC A9 */	bl TRKSetBufferPosition
/* 80401BC4 003F7944  38 61 00 10 */	addi r3, r1, 0x10
/* 80401BC8 003F7948  38 80 00 40 */	li r4, 0x40
/* 80401BCC 003F794C  48 00 3F DD */	bl TRKReadUARTN
/* 80401BD0 003F7950  2C 03 00 00 */	cmpwi r3, 0
/* 80401BD4 003F7954  40 82 00 58 */	bne lbl_80401C2C
/* 80401BD8 003F7958  80 61 00 08 */	lwz r3, 8(r1)
/* 80401BDC 003F795C  38 81 00 10 */	addi r4, r1, 0x10
/* 80401BE0 003F7960  38 A0 00 40 */	li r5, 0x40
/* 80401BE4 003F7964  4B FF F9 F1 */	bl TRKAppendBuffer_ui8
/* 80401BE8 003F7968  80 61 00 10 */	lwz r3, 0x10(r1)
/* 80401BEC 003F796C  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 80401BF0 003F7970  34 83 FF C0 */	addic. r4, r3, -64
/* 80401BF4 003F7974  40 81 00 44 */	ble lbl_80401C38
/* 80401BF8 003F7978  38 61 00 50 */	addi r3, r1, 0x50
/* 80401BFC 003F797C  48 00 3F AD */	bl TRKReadUARTN
/* 80401C00 003F7980  2C 03 00 00 */	cmpwi r3, 0
/* 80401C04 003F7984  40 82 00 18 */	bne lbl_80401C1C
/* 80401C08 003F7988  80 61 00 08 */	lwz r3, 8(r1)
/* 80401C0C 003F798C  38 81 00 50 */	addi r4, r1, 0x50
/* 80401C10 003F7990  80 A1 00 10 */	lwz r5, 0x10(r1)
/* 80401C14 003F7994  4B FF F9 C1 */	bl TRKAppendBuffer_ui8
/* 80401C18 003F7998  48 00 00 20 */	b lbl_80401C38
lbl_80401C1C:
/* 80401C1C 003F799C  7F E3 FB 78 */	mr r3, r31
/* 80401C20 003F79A0  4B FF FC B9 */	bl TRKReleaseBuffer
/* 80401C24 003F79A4  3B E0 FF FF */	li r31, -1
/* 80401C28 003F79A8  48 00 00 10 */	b lbl_80401C38
lbl_80401C2C:
/* 80401C2C 003F79AC  7F E3 FB 78 */	mr r3, r31
/* 80401C30 003F79B0  4B FF FC A9 */	bl TRKReleaseBuffer
/* 80401C34 003F79B4  3B E0 FF FF */	li r31, -1
lbl_80401C38:
/* 80401C38 003F79B8  7F E3 FB 78 */	mr r3, r31
lbl_80401C3C:
/* 80401C3C 003F79BC  80 01 08 E4 */	lwz r0, 0x8e4(r1)
/* 80401C40 003F79C0  83 E1 08 DC */	lwz r31, 0x8dc(r1)
/* 80401C44 003F79C4  7C 08 03 A6 */	mtlr r0
/* 80401C48 003F79C8  38 21 08 E0 */	addi r1, r1, 0x8e0
/* 80401C4C 003F79CC  4E 80 00 20 */	blr 

