.include "macros.inc"

.section .text, "ax"  # 0x8000C860 - 0x804064E0

.global NWC24iPrepareShutdown
NWC24iPrepareShutdown:
/* 803A5CB0 0039BA30  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 803A5CB4 0039BA34  7C 08 02 A6 */	mflr r0
/* 803A5CB8 0039BA38  90 01 00 24 */	stw r0, 0x24(r1)
/* 803A5CBC 0039BA3C  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 803A5CC0 0039BA40  3B E0 00 00 */	li r31, 0
/* 803A5CC4 0039BA44  4B FF 43 0D */	bl NWC24iRegister
/* 803A5CC8 0039BA48  3C A0 80 3A */	lis r5, NWC24Shutdown@ha
/* 803A5CCC 0039BA4C  3C 80 80 53 */	lis r4, lbl_80537620@ha
/* 803A5CD0 0039BA50  38 A5 5D 70 */	addi r5, r5, NWC24Shutdown@l
/* 803A5CD4 0039BA54  38 00 00 6E */	li r0, 0x6e
/* 803A5CD8 0039BA58  38 64 76 20 */	addi r3, r4, lbl_80537620@l
/* 803A5CDC 0039BA5C  90 A4 76 20 */	stw r5, 0x7620(r4)
/* 803A5CE0 0039BA60  90 03 00 04 */	stw r0, 4(r3)
/* 803A5CE4 0039BA64  4B E3 93 01 */	bl OSRegisterShutdownFunction
/* 803A5CE8 0039BA68  80 0D B9 E8 */	lwz r0, lbl_8059FE08-_SDA_BASE_(r13)
/* 803A5CEC 0039BA6C  2C 00 00 00 */	cmpwi r0, 0
/* 803A5CF0 0039BA70  40 80 00 24 */	bge lbl_803A5D14
/* 803A5CF4 0039BA74  3C 60 80 49 */	lis r3, lbl_80492448@ha
/* 803A5CF8 0039BA78  3C 80 80 49 */	lis r4, lbl_80492460@ha
/* 803A5CFC 0039BA7C  38 63 24 48 */	addi r3, r3, lbl_80492448@l
/* 803A5D00 0039BA80  38 AD B9 E8 */	addi r5, r13, lbl_8059FE08-_SDA_BASE_
/* 803A5D04 0039BA84  38 84 24 60 */	addi r4, r4, lbl_80492460@l
/* 803A5D08 0039BA88  38 C0 00 01 */	li r6, 1
/* 803A5D0C 0039BA8C  4B FF CA 91 */	bl NWC24iOpenResourceManager
/* 803A5D10 0039BA90  7C 7F 1B 78 */	mr r31, r3
lbl_803A5D14:
/* 803A5D14 0039BA94  38 00 00 05 */	li r0, 5
/* 803A5D18 0039BA98  90 0D CD B0 */	stw r0, lbl_805A11D0-_SDA_BASE_(r13)
lbl_803A5D1C:
/* 803A5D1C 0039BA9C  4B E6 84 71 */	bl SCCheckStatus
/* 803A5D20 0039BAA0  28 03 00 02 */	cmplwi r3, 2
/* 803A5D24 0039BAA4  41 82 00 1C */	beq lbl_803A5D40
/* 803A5D28 0039BAA8  28 03 00 01 */	cmplwi r3, 1
/* 803A5D2C 0039BAAC  41 82 FF F0 */	beq lbl_803A5D1C
/* 803A5D30 0039BAB0  38 61 00 08 */	addi r3, r1, 8
/* 803A5D34 0039BAB4  4B E6 9E E5 */	bl SCGetIdleMode
/* 803A5D38 0039BAB8  88 61 00 09 */	lbz r3, 9(r1)
/* 803A5D3C 0039BABC  4B E3 CB 7D */	bl __OSSetIdleLEDMode
lbl_803A5D40:
/* 803A5D40 0039BAC0  4B E3 08 E1 */	bl OSGetAppType
/* 803A5D44 0039BAC4  54 60 06 3E */	clrlwi r0, r3, 0x18
/* 803A5D48 0039BAC8  28 00 00 40 */	cmplwi r0, 0x40
/* 803A5D4C 0039BACC  40 82 00 0C */	bne lbl_803A5D58
/* 803A5D50 0039BAD0  38 60 00 01 */	li r3, 1
/* 803A5D54 0039BAD4  4B FF AC F5 */	bl NWC24iSetScriptMode
lbl_803A5D58:
/* 803A5D58 0039BAD8  7F E3 FB 78 */	mr r3, r31
/* 803A5D5C 0039BADC  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 803A5D60 0039BAE0  80 01 00 24 */	lwz r0, 0x24(r1)
/* 803A5D64 0039BAE4  7C 08 03 A6 */	mtlr r0
/* 803A5D68 0039BAE8  38 21 00 20 */	addi r1, r1, 0x20
/* 803A5D6C 0039BAEC  4E 80 00 20 */	blr 

.global NWC24Shutdown
NWC24Shutdown:
/* 803A5D70 0039BAF0  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 803A5D74 0039BAF4  7C 08 02 A6 */	mflr r0
/* 803A5D78 0039BAF8  2C 03 00 00 */	cmpwi r3, 0
/* 803A5D7C 0039BAFC  90 01 00 14 */	stw r0, 0x14(r1)
/* 803A5D80 0039BB00  41 82 00 0C */	beq lbl_803A5D8C
/* 803A5D84 0039BB04  38 60 00 01 */	li r3, 1
/* 803A5D88 0039BB08  48 00 00 A8 */	b lbl_803A5E30
lbl_803A5D8C:
/* 803A5D8C 0039BB0C  80 0D CD B4 */	lwz r0, lbl_805A11D4-_SDA_BASE_(r13)
/* 803A5D90 0039BB10  2C 00 00 00 */	cmpwi r0, 0
/* 803A5D94 0039BB14  41 82 00 54 */	beq lbl_803A5DE8
/* 803A5D98 0039BB18  4B FF CB 55 */	bl NWC24iIsAsyncRequestPending
/* 803A5D9C 0039BB1C  2C 03 00 00 */	cmpwi r3, 0
/* 803A5DA0 0039BB20  41 82 00 0C */	beq lbl_803A5DAC
/* 803A5DA4 0039BB24  38 60 00 00 */	li r3, 0
/* 803A5DA8 0039BB28  48 00 00 88 */	b lbl_803A5E30
lbl_803A5DAC:
/* 803A5DAC 0039BB2C  80 0D CD B8 */	lwz r0, lbl_805A11D8-_SDA_BASE_(r13)
/* 803A5DB0 0039BB30  2C 00 00 00 */	cmpwi r0, 0
/* 803A5DB4 0039BB34  41 80 00 0C */	blt lbl_803A5DC0
/* 803A5DB8 0039BB38  38 60 00 01 */	li r3, 1
/* 803A5DBC 0039BB3C  48 00 00 74 */	b lbl_803A5E30
lbl_803A5DC0:
/* 803A5DC0 0039BB40  80 6D CD B0 */	lwz r3, lbl_805A11D0-_SDA_BASE_(r13)
/* 803A5DC4 0039BB44  2C 03 00 00 */	cmpwi r3, 0
/* 803A5DC8 0039BB48  40 81 00 18 */	ble lbl_803A5DE0
/* 803A5DCC 0039BB4C  38 03 FF FF */	addi r0, r3, -1
/* 803A5DD0 0039BB50  38 60 00 00 */	li r3, 0
/* 803A5DD4 0039BB54  90 6D CD B4 */	stw r3, lbl_805A11D4-_SDA_BASE_(r13)
/* 803A5DD8 0039BB58  90 0D CD B0 */	stw r0, lbl_805A11D0-_SDA_BASE_(r13)
/* 803A5DDC 0039BB5C  48 00 00 50 */	b lbl_803A5E2C
lbl_803A5DE0:
/* 803A5DE0 0039BB60  38 60 00 01 */	li r3, 1
/* 803A5DE4 0039BB64  48 00 00 4C */	b lbl_803A5E30
lbl_803A5DE8:
/* 803A5DE8 0039BB68  3C A0 80 53 */	lis r5, lbl_80537640@ha
/* 803A5DEC 0039BB6C  3C 60 80 49 */	lis r3, lbl_80492474@ha
/* 803A5DF0 0039BB70  90 85 76 40 */	stw r4, lbl_80537640@l(r5)
/* 803A5DF4 0039BB74  3D 00 80 53 */	lis r8, lbl_80537660@ha
/* 803A5DF8 0039BB78  38 C5 76 40 */	addi r6, r5, 0x7640
/* 803A5DFC 0039BB7C  80 8D B9 E8 */	lwz r4, lbl_8059FE08-_SDA_BASE_(r13)
/* 803A5E00 0039BB80  38 63 24 74 */	addi r3, r3, lbl_80492474@l
/* 803A5E04 0039BB84  39 08 76 60 */	addi r8, r8, lbl_80537660@l
/* 803A5E08 0039BB88  38 A0 00 28 */	li r5, 0x28
/* 803A5E0C 0039BB8C  38 E0 00 20 */	li r7, 0x20
/* 803A5E10 0039BB90  39 20 00 20 */	li r9, 0x20
/* 803A5E14 0039BB94  39 4D CD B8 */	addi r10, r13, lbl_805A11D8-_SDA_BASE_
/* 803A5E18 0039BB98  4B FF CA 79 */	bl NWC24iIoctlResourceManagerAsync
/* 803A5E1C 0039BB9C  2C 03 00 00 */	cmpwi r3, 0
/* 803A5E20 0039BBA0  41 80 00 0C */	blt lbl_803A5E2C
/* 803A5E24 0039BBA4  38 00 00 01 */	li r0, 1
/* 803A5E28 0039BBA8  90 0D CD B4 */	stw r0, lbl_805A11D4-_SDA_BASE_(r13)
lbl_803A5E2C:
/* 803A5E2C 0039BBAC  38 60 00 00 */	li r3, 0
lbl_803A5E30:
/* 803A5E30 0039BBB0  80 01 00 14 */	lwz r0, 0x14(r1)
/* 803A5E34 0039BBB4  7C 08 03 A6 */	mtlr r0
/* 803A5E38 0039BBB8  38 21 00 10 */	addi r1, r1, 0x10
/* 803A5E3C 0039BBBC  4E 80 00 20 */	blr 

